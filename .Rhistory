fit %>%
select("hwdamped") %>%
gg_tsresiduals()
augment(fit) %>%
filter(.model == "hwdamped") %>%
features(.innov, ljung_box, dof = 17, lag = 36)
myseries %>%
filter(year(Month) < 2011) %>%
model(
snaive = SNAIVE(Turnover),
hw = ETS(Turnover ~ error("M") + trend("A") + season("M")),
hwdamped = ETS(Turnover ~ error("M") + trend("Ad") + season("M"))
) %>%
forecast(h = "7 years") %>%
accuracy(myseries)
stl <- decomposition_model(
STL(log(Turnover)),
ETS(season_adjust ~ season("N"))
)
fc <- myseries %>%
filter(year(Month) < 2011) %>%
model(
stl_ets = stl,
snaive = SNAIVE(Turnover),
hwdamped = ETS(Turnover ~ error("M") + trend("Ad") + season("M"))
) %>%
forecast(h = "7 years")
fc %>% autoplot(filter(myseries, year(Month) > 2004), level = NULL)
fc %>% accuracy(myseries)
aus_trips <- tourism %>%
summarise(Trips = sum(Trips))
aus_trips %>%
autoplot(Trips)
dcmp <- aus_trips %>%
model(STL(Trips)) %>%
components()
dcmp %>%
as_tsibble() %>%
autoplot(season_adjust)
stletsdamped <- decomposition_model(
STL(Trips),
ETS(season_adjust ~ error("A") + trend("Ad") + season("N"))
)
aus_trips %>%
model(dcmp_AAdN = stletsdamped) %>%
forecast(h = "2 years") %>%
autoplot(aus_trips)
stletstrend <- decomposition_model(
STL(Trips),
ETS(season_adjust ~ error("A") + trend("A") + season("N"))
)
aus_trips %>%
model(dcmp_AAN = stletstrend) %>%
forecast(h = "2 years") %>%
autoplot(aus_trips)
aus_trips %>%
model(ets = ETS(Trips)) %>%
forecast(h = "2 years") %>%
autoplot(aus_trips)
fit <- aus_trips %>%
model(
dcmp_AAdN = stletsdamped,
dcmp_AAN = stletstrend,
ets = ETS(Trips)
)
accuracy(fit)
fit %>%
forecast(h = "2 years") %>%
autoplot(aus_trips, level = NULL)
best <- fit %>%
select(dcmp_AAN)
augment(best) %>% gg_tsdisplay(.resid, lag_max = 24, plot_type = "histogram")
augment(best) %>%
features(.innov, ljung_box, lag = 24, dof = 4)
nzarrivals <- aus_arrivals %>% filter(Origin == "NZ")
nzarrivals %>% autoplot(Arrivals / 1e3) + labs(y = "Thousands of people")
nz_tr <- nzarrivals %>%
slice(1:(n() - 8))
nz_tr %>%
model(ETS(Arrivals ~ error("M") + trend("A") + season("M"))) %>%
forecast(h = "2 years") %>%
autoplot() +
autolayer(nzarrivals, Arrivals)
fc <- nz_tr %>%
model(
ets = ETS(Arrivals),
log_ets = ETS(log(Arrivals)),
snaive = SNAIVE(Arrivals),
stl = decomposition_model(STL(log(Arrivals)), ETS(season_adjust))
) %>%
forecast(h = "2 years")
fc %>%
autoplot(level = NULL) +
autolayer(filter(nzarrivals, year(Quarter) > 2000), Arrivals)
fc %>%
autoplot(level = NULL) +
autolayer(nzarrivals, Arrivals)
fc %>%
accuracy(nzarrivals)
log_ets <- nz_tr %>%
model(ETS(log(Arrivals)))
log_ets %>% gg_tsresiduals()
augment(log_ets) %>%
features(.innov, ljung_box, lag = 12, dof = 6)
nz_cv <- nzarrivals %>%
slice(1:(n() - 3)) %>%
stretch_tsibble(.init = 36, .step = 3)
nz_cv %>%
model(
ets = ETS(Arrivals),
log_ets = ETS(log(Arrivals)),
snaive = SNAIVE(Arrivals),
stl = decomposition_model(STL(log(Arrivals)), ETS(season_adjust))
) %>%
forecast(h = 3) %>%
accuracy(nzarrivals)
cement_cv <- aus_production %>%
slice(1:(n() - 4)) %>%
stretch_tsibble(.init = 5 * 4)
fc <- cement_cv %>%
model(ETS(Cement), SNAIVE(Cement)) %>%
forecast(h = "1 year")
fc %>%
group_by(.id, .model) %>%
mutate(h = row_number()) %>%
ungroup() %>%
accuracy(aus_production, by = c(".model", "h"))
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, cache=TRUE)
library(fpp3)
update <- readr::read_csv("ttps://fred.stlouisfed.org/series/CEU7000000001.csv")
update <- readr::read_csv("https://fred.stlouisfed.org/series/CEU7000000001.csv")
update <- readr::read_csv("https://fred.stlouisfed.org/series/CEU7000000001")
update
update <- readr::read_csv("https://fred.stlouisfed.org/series/CEU7000000001.csv")
update <- readr::read_csv("https://fred.stlouisfed.org/series/CEU7000000001
https://fred.stlouisfed.org/graph/fredgraph.csv?bgcolor=%23e1e9f0&chart_type=line&drp=0&fo=open%20sans&graph_bgcolor=%23ffffff&height=450&mode=fred&recession_bars=on&txtcolor=%23444444&ts=12&tts=12&width=1168&nt=0&thu=0&trc=0&show_legend=yes&show_axis_titles=yes&show_tooltip=yes&id=CEU7000000001&scale=left&cosd=1939-01-01&coed=2022-05-01&line_color=%234572a7&link_values=false&line_style=solid&mark_type=none&mw=3&lw=2&ost=-99999&oet=99999&mma=0&fml=a&fq=Monthly&fam=avg&fgst=lin&fgsnd=2020-02-01&line_index=1&transformation=lin&vintage_date=2022-06-09&revision_date=2022-06-09&nd=1939-01-01") %>%
m
update <- readr::read_csv("https://fred.stlouisfed.org/graph/fredgraph.csv?bgcolor=%23e1e9f0&chart_type=line&drp=0&fo=open%20sans&graph_bgcolor=%23ffffff&height=450&mode=fred&recession_bars=on&txtcolor=%23444444&ts=12&tts=12&width=1168&nt=0&thu=0&trc=0&show_legend=yes&show_axis_titles=yes&show_tooltip=yes&id=CEU7000000001&scale=left&cosd=1939-01-01&coed=2022-05-01&line_color=%234572a7&link_values=false&line_style=solid&mark_type=none&mw=3&lw=2&ost=-99999&oet=99999&mma=0&fml=a&fq=Monthly&fam=avg&fgst=lin&fgsnd=2020-02-01&line_index=1&transformation=lin&vintage_date=2022-06-09&revision_date=2022-06-09&nd=1939-01-01")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE)
library(tidyverse)
library(ggplot2)
Beer <- readRDS("~/Desktop/Sem 4/ETF5500/data/Beer.rds")
filename <- file.choose()
Beer <- readRDS(filename)
filename <- file.choose()
temp <- readRDS(filename)
filename <- file.choose()
temp <- read.csv(filename)
remove(temp)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE)
Beer <- readRDS("~/Desktop/Sem4/ETF5500/data/Beer.rds")
# Beer <- readRDS("~/Desktop/Sem4/ETF5500/data/Beer.rds")
filename <- file.choose()
Beer <- readRDS(filename)
qplot(price, data = Beer, geom = "histogram")
qplot(price, data = Beer, geom = "histogram", bins = 30)
View(Beer)
beer %>%
group_by(origin, rating) %>%
count(origin)
Beer %>%
group_by(origin, rating) %>%
count(rating)
Beer %>%
group_by(origin, rating) %>%
count(origin)
Beer %>%
group_by(origin, rating) %>%
count()
Beer %>%
group_by(origin, rating) %>%
summarise(count = count())
Beer %>%
group_by(origin, rating) %>%
count() %>%
rename( count = n)
Beer %>%
group_by(origin, rating) %>%
count() %>%
rename( count = n) %>%
pivot_wider(names_from = rating,
values_from = count)
table(Beer$origin, Beer$rating)
Beer %>%
group_by(origin, rating) %>%
count() %>%
rename( count = n) %>%
pivot_wider(names_from = origin,
values_from = count)
# Beer %>%
#   group_by(origin, rating) %>%
#   count() %>%
#   rename( count = n) %>%
#   pivot_wider(names_from = origin,
#               values_from = count)
table(Beer$rating, Beer$origin)
# table(Beer$origin, Beer$rating)
ggplot(Beer, aes(price)) +
geom_histogram( bins = 30)
version
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE)
library(tidyverse)
library(ggplot2)
library(tidyverse)
library(ggplot2)
library(geojsonio)
install.packages("geojsonio")
library(tidyverse)
library(ggplot2)
library(geojsonio)
filename <- file.choose()
data <- readRDS(filename)
data <- read_csv(filename)
remove(Beer)
filename
spdf <- geojson_read("https://raw.githubusercontent.com/gregoiredavid/france-geojson/master/communes.geojson",  what = "sp")
View(spdf)
library(broom)
spdf_fortified <- tidy(spdf, region = "code")
View(data)
spdf_fortified <- tidy(spdf, region = "code")
spdf@data[["code"]]
knitr::opts_chunk$set(echo = TRUE,
warning = FALSE,
message = FALSE)
library(tidyverse)
library(dplyr)
library(tidyverse)
library(dplyr)
library(tidyverse)
library(dplyr)
red_df <- read.delim("Desktop/Sem4/ETC5555/Week1/data/winequality-red.csv", delim = ";")
red_df <- read.delim("Desktop/Sem4/ETC5555/Week1/data/winequality-red.csv", delim = ";")
red_df <- read.delim("/User/prachi/Desktop/Sem4/ETC5555/Week1/data/winequality-red.csv", delim = ";")
red_df <- read.delim("~User/prachi/Desktop/Sem4/ETC5555/Week1/data/winequality-red.csv", delim = ";")
red_df <- read.delim("~/User/prachi/Desktop/Sem4/ETC5555/Week1/data/winequality-red.csv", delim = ";")
red_df <- read.delim("~Desktop/Sem4/ETC5555/Week1/data/winequality-red.csv", delim = ";")
red_df <- file.choose()
red_df <- read.delim(red_df, delim = ";")
red_df <- read_delim(red_df, delim = ";")
red_df <- read_delim("~Desktop/Sem4/ETC5555/Week1/data/winequality-red.csv", delim = ";")
white_df <- file.choose()
white_df <- read_delim(white_df, delim = ";")
names(red_df) <- str_replace_all(names(red_df), " ", "_")
names(white_df) <- str_replace_all(names(red_df), " ", "_")
red_df <- mutate(red_df, wine = "Red")
white_df <- mutate(white_df, wine = "White")
wine_df <- bind_rows(red_df, white_df)
wine_df <- mutate(wine_df, good_quality = ifelse(quality >= 7, TRUE, FALSE))
wine_df <- mutate(wine_df, id = row_number())
View(red_df)
wine_df <- red_df %>%
bind_rows(white_df) %>%
mutate(good_quality = ifelse(quality >= 7, TRUE, FALSE),
id = row_number()) %>%
select(id,wine,everything())
wine_df1 <- red_df %>%
bind_rows(white_df) %>%
mutate(good_quality = ifelse(quality >= 7, TRUE, FALSE),
id = row_number()) %>%
select(id,wine,everything())
quality_df <- tribble(
~ quality, ~ quality_cat,
3, "Bad",
4, "Bad",
5, "Average",
6, "Average",
7, "Good",
8, "Good",
9, "Good",
)
wine_df <- wine_df %>%
inner_join(quality_df, "quality")
View(quality_df)
View(wine_df)
wine_df %>%
map(~ sum(is.na(.x))) %>%
unlist()
wine_df %>%
filter(is.na(total_sulfur_dioxide))
wine_df %>%
map(~ sum(is.na(.x))) %>%
unlist()
wine_df_lng <-  wine_df %>%
gather()
wine_df_lng
wine_df_lng <-  wine_df %>%
gather(variable, value, -c(id, wine, quality_cat, good_quality))
wine_df_lng
spread(wine_df_lng, variable, value)
wine_df_stats <-  wine_df_lng %>%
group_by(wine, quality_cat, variable) %>%
summarise(Median = median(value),
SD = sd(value))
wine_df_stats
wine_df_stats %>%
select(-SD) %>%
spread(variable, Median)
library(rpart.plot)
plot_dt <- function(tree, title) {
rpart.plot(tree, main = title)
}
walk2(fit_df$model_dt, paste(fit_df$wine, "wine quality decision tree"), plot_dt)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE)
filename <- file.choose()
data <- read_csv(filename)
View(data)
View(spdf)
library(tidyverse)
library(dplyr)
Drinks<-c("Coke", "Pepsi", "7up", "Solo")
print(Drinks)
str(Drinks)
log(Inf)
Nationality <-  'The Australian '
Sport <-  'Soccer'
Event_Name <-  'World Cup'
Rivals <-  'Peru'
WC_stage <-  'play-offs'
Phrase <- paste0(Nationality,Sport,
' team has made it to the',
Event_Name,
'. They beat ',
Rivals,' in the international ',
WC_stage)
str(Phrase)
Phrase <- paste0(Nationality,Sport,
' team has made it to the ',
Event_Name,
'. They beat ',
Rivals,' in the international ',
WC_stage, '.')
str(Phrase)
print(Phrase)
Phrase
library(ggplot2)
mpg
qplot(x=cty,y=hwy,data=mpg)
qplot(x=cty,data=mpg)
View(data)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE)
library(tidyverse)
library(ggplot2)
library(geojsonio)
library(broom)
filename <- file.choose()
data <- read_csv(filename)
View(data)
unique(data$SA4_NAME_2011)
unique(data$SA3_NAME_2011)
knitr::opts_chunk$set(echo = FALSE,
cache=TRUE,
messages=FALSE,
warning=FALSE)
library(tidyverse)
library(ggplot2)
library(plotly)
library(readxl)
library(ggmap)
library(ggthemes)
library(gridExtra)
library(kableExtra)
library(rmdformats)
library(patchwork)
ala_data <- read_csv(here::here("~/assignment1_template/data/task2.csv"))
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE)
library(tidyverse)
library(ggplot2)
library(dplyr)
filename <- file.choose()
Beer <- readRDS(filename)
View(Beer)
ggplot(Beer, aes(cost)) +
geom_histogram( bins = 30)
ggplot(Beer, aes(x= light,
y = alcohol))+
geom_boxplot()
?frequency_table
?frequencytable
ggplot(Beer, aes(cost,
fill = light)) +
geom_histogram( bins = 30)
ggplot(Beer, aes(x= light,
y = alcohol,
fill = light))+
geom_boxplot()
table(Beer$rating)
table(Beer$rating, Beer$light)
data <- file.choose()
comScore <- readRDS(data)
View(comScore)
ggplot(comScore, aes(Sales)) +
geom_histogram( bins = 30)
ggplot(comScore, aes(Duration)) +
geom_histogram( bins = 30)
ggplot(comScore, aes(PageViews)) +
geom_histogram( bins = 30)
summary(comScore)
ggplot(comScore, aes(x= Duration,
y= PageViews,
fill = Buy))+
geom_point()
ggplot(comScore, aes(x= Duration,
y= PageViews,
color = Buy))+
geom_point()
ggplot(comScore, aes(x= Duration,
y= PageViews))+
geom_point()
new_comScore <- comScore %>%
filter(Duration > 1000,
PageViews > 900)
ggplot(new_comScore, aes(x= Duration,
y= PageViews))+
geom_point()
View(new_comScore)
new_comScore <- comScore %>%
group_by(Sales, Duration, Buy, PageViews) %>%
filter(Duration > 1000,
PageViews > 900)
new_comScore <- comScore %>%
filter(Duration < 1000,
PageViews < 900)
ggplot(new_comScore, aes(x= Duration,
y= PageViews))+
geom_point()
ggplot(new_comScore, aes(x= Duration,
y= PageViews,
color = Buy))+
geom_point()
ggplot(comScore, aes(x= Duration,
y= PageViews,
color = Buy))+
geom_point()
ggplot(new_comScore, aes(x= Duration,
y= PageViews))+
geom_point()
new_comScore <- comScore %>%
filter(Duration < 1000,
PageViews < 900)
ggplot(new_comScore, aes(x= Duration,
y= PageViews,
color = Buy))+
geom_point()
new_comScore
Beer %>%
group_by(light, rating) %>%
count() %>%
rename( count = n)
table(Beer$rating, Beer$light)
Beer %>%
group_by(light, rating) %>%
count() %>%
rename( count = n)
Beer %>%
group_by(light, rating) %>%
count() %>%
rename( count = n) %>%
pivot_wider(names_from = light,
values_from = count)
Beer %>%
group_by(rating) %>%
count() %>%
rename( count = n)
table(Beer$rating)
Beer %>%
group_by(rating) %>%
count() %>%
rename( count = n)
ggplot(new_comScore, aes(x= Duration,
y= PageViews))+
geom_point(alpha = 0.5)
ggplot(new_comScore, aes(x= Duration,
y= PageViews))+
geom_point(alpha = 0.1)
ggplot(new_comScore, aes(x= Duration,
y= PageViews))+
geom_point(alpha = 0.2)
knitr::opts_chunk$set(echo = TRUE,
message = FALSE,
warning = FALSE)
library(tidyverse)
library(ggplot2)
library(sf)
library(broom)
library(readxl)
library(rgdal)
library(themis)
library(leaflet)
library(openxlsx)
# full_data <- read_csv(file.choose())
# SA3 Shape File
shapefile_df <- readOGR(dsn = paste0(getwd(), "/Data/SA3_2011/")) %>%
fortify(region = "SA3_NAME11")%>%
rename(alat = lat,
along = long,
aname = id)
