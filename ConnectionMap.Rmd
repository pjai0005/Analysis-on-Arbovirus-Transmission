---
title: "Connection Map"
author: "Sahinya Akila, Prachi Jaiswal"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE)
```

```{r}
library(tidyverse)
library(ggplot2)
library(sf)
library(broom)
library(readxl)
library(rgdal)
```

```{r read_data}
full_data <- read_csv(file.choose())
 
sa3_geo_data <- st_as_sf(st_read("data/SA3_2011/SA3_2011_AUST.shp")) %>% 
  select(SA3_NAME11)
```


```{r, cleaning}

filename <- file.choose()
virus_list <-  c("Dengue", 
                   "West_Nile_Kunjin", 
                   "Zika", 
                   "Chikungunya",
                   "Japanese_Encephalitis_Virus")
  
con_data <- data.frame()
  
for(i in 1:5)
  {
    con_data <- rbind(con_data, read_excel(filename, sheet = i) %>%
                        add_column(Virus = virus_list[i]))
  }


 connection_data <- con_data %>% 
   filter(!`Country of Origin` %in% c("No data available", "Overseas - Country unknown", 
                                      "At Sea", "Unknown", "No data supplied") &
            !`Residential location (SA3)` %in% c("No data available", "Overseas - Country unknown", 
                                      "At Sea", "No data supplied", "Unknown")) %>% 
   mutate(`Country of Origin` = 
      ifelse(`Country of Origin` =="China (excludes SARs and Taiwan)", "China",
      ifelse(`Country of Origin` == "Venezuela, Bolivarian Republic of", "Venezuela",
      ifelse(`Country of Origin` == "Samoa, American", "Samoa",
      ifelse(`Country of Origin` == "Bolivia, Plurinational State of", "Bolivia",
      ifelse(`Country of Origin` == "Congo, Democratic Republic of", "Congo",
      ifelse(`Country of Origin` == "Macau (SAR of China)", "Macau",
      ifelse(`Country of Origin` == "United Kingdom, Channel Islands and Isle of Man", "United Kingdom",
      ifelse(`Country of Origin` == "Hong Kong (SAR of China)", "Hong Kong",
      ifelse(`Country of Origin` == "Congo, Republic of", "Congo", 
      ifelse(`Country of Origin` == "Myanmar, The Republic of the Union of", "Myanmar", `Country of Origin`)))))))))))
 
 connection_data <- connection_data[!grepl("nfd|nec", connection_data$`Country of Origin`),] 


```

```{r read_shapefile}

# SA3 Shape File
shapefile <- readOGR(dsn = paste0(getwd(), "/Data/SA3_2011/"))

shapefile_df <- fortify(shapefile, region = "SA3_NAME11")


# World Data Shape File
world_df <- readOGR( 
  dsn= paste0(getwd(),"/DATA/World_Shapefile/") , 
  layer="TM_WORLD_BORDERS_SIMPL-0.3",
  verbose=FALSE) %>% fortify(region = "NAME")


# Binding shape files
joint_data <- rbind(world_df, shapefile_df)

ggplot() +
geom_path(data = joint_data, 
          aes(x = long, y = lat, group = group),
          color = 'Dark Green', fill = 'white', size = .2)

```

